---
- name: Install Google Chrome on AlmaLinux and Ubuntu
  hosts: all
  become: yes
  
  tasks:
    - name: Ensure Google Chrome repository is added on RedHat-based systems
      ansible.builtin.yum_repository:
        name: google-chrome
        description: Google Chrome
        baseurl: https://dl.google.com/linux/chrome/rpm/stable/$basearch
        enabled: yes
        gpgcheck: yes
        gpgkey: https://dl.google.com/linux/linux_signing_key.pub
      when: ansible_os_family == "RedHat"
    
    - name: Install Google Chrome on RedHat-based systems
      ansible.builtin.dnf:
        name: google-chrome-stable
        state: present
      when: ansible_os_family == "RedHat"
      
    - name: Download and install Google Chrome on Debian-based systems
      ansible.builtin.apt:
        deb: https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
        state: present
        install_recommends: no
      when: ansible_os_family == "Debian"

    - name: Install required dependency for Google Chrome on Debian-based systems
      ansible.builtin.apt:
        name: libu2f-udev
        state: present
      when: ansible_os_family == "Debian"
